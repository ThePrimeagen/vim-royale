use crate::state::AppState;

pub fn str_to_vec_usize(string: String) -> Vec<usize> {
    let mut vec: Vec<usize> = vec![];

    for c in string.chars() {
        let digit = c.to_digit(10).unwrap_or(0) as usize;
        vec.push(digit);
    }

    return vec;
}

pub fn the_primeagen() -> Vec<Vec<usize>> {
    return vec![
        str_to_vec_usize("000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000".into()),
        str_to_vec_usize("011111111111111011111100111111011111111111111000011111100000000001111110111111111111110111111000000000011111101111111111111100001111111111011111111111111000000000111111111111110111111001111110111111111111110001111111111111101111111111111111000111111111101111110000000000111111011111111111111011111111111111011111111111111011111111111111011111100000000001111110".into()),
        str_to_vec_usize("011222222222211011221100112211011222222222211000011221111111111001122110112222222222110112211111111111111221101122222222221100001122222211011222222222211000000000112222222222110112211001122110112222222222110001122222222221101122222222222211000112222221101122111111111111112211011222222222211011222222222211011222222222211011222222222211011221111111111001122110".into()),
        str_to_vec_usize("011111122111111011221100112211011221111111111000011222222222211001122110112211111122110112222222222222222221101122111111111100001111221111011221111111111000000000111111221111110112211001122110112211111111110001122111111221101122111111112211000111122111101122222222222222222211011221111111111011221111112211011221111111111011221111111111011222222222211001122110".into()),
        str_to_vec_usize("000001122110000011221100112211011221100000000000011221111112211001122110112211001122110112211111122111111221101122110000000000000011221100011221100000000000000000000011221100000112211001122110112211000000000001122110011221101122110000112211000001122110001122111111221111112211011221100000000011221100112211011221100000000011221100000000011221111112211001122110".into()),
        str_to_vec_usize("000001122110000011221111112211011221111111111000011221100112211001122110112211111122110112211001122110011221101122111111111100000011221100011221111111111000000000000011221100000112211111122110112211111111110001122111111221101122111111112211000001122110001122110011221100112211011221111111111011221111112211011221100000000011221111111111011221100112211001122110".into()),
        str_to_vec_usize("000001122110000011222222222211011222222222211000011221100112211001122110112222222222110112211001122110011221101122222222221100000011221100011222222222211000000000000011221100000112222222222110112222222222110001122222222221101122222222222211000001122110001122110011221100112211011222222222211011222222222211011221100111111011222222222211011221100112211001122110".into()),
        str_to_vec_usize("000001122110000011221111112211011221111111111000011221100112211001122110112211111122110112211001111110011221101122111111111100000011221100011111111112211000000000000011221100000112211111122110112211111111110001122111111111101122111111221111000001122110001122110011111100112211011221111111111011221111112211011221100112211011221111111111011221100112211001122110".into()),
        str_to_vec_usize("000001122110000011221100112211011221100000000000011221100112211111122110112211001122110112211000000000011221101122110000000000000011221100000000000112211011111100000011221100000112211001122110112211000000000001122110000000001122110011221100000001122110001122110000000000112211011221100000000011221100112211011221100112211011221100000000011221100112211111122110".into()),
        str_to_vec_usize("000001122110000011221100112211011221111111111000011221100112222222222110112211001122110112211000000000011221101122111111111100001111221111011111111112211011221100000011221100000112211001122110112211111111110001122110000000001122110011221111110111122111101122110000000000112211011221111111111011221100112211011221111112211011221111111111011221100112222222222110".into()),
        str_to_vec_usize("000001122110000011221100112211011222222222211000011221100111111111122110112211001122110112211000000000011221101122222222221100001122222211011222222222211011111100000011221100000112211001122110112222222222110001122110000000001122110011222222110112222221101122110000000000112211011222222222211011221100112211011222222222211011222222222211011221100111111111122110".into()),
        str_to_vec_usize("000001111110000011111100111111011111111111111000011111100000000001111110111111001111110111111000000000011111101111111111111100001111111111011111111111111000001100000011111100000111111001111110111111111111110001111110000000001111110011111111110111111111101111110000000000111111011111111111111011111100111111011111111111111011111111111111011111100000000001111110".into()),
        str_to_vec_usize("000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000".into()),
    ];
}

pub fn scroll_strings(
    strings: Vec<Vec<usize>>,
    start_row: usize,
) -> impl FnMut(&'static AppState) -> bool {
    let mut offset: usize = 0;
    let rows = strings.len();
    let cols = strings[0].len();

    return move |state: &'static AppState| {
        let display_cols = state.terminal_display[0].len();

        offset += 1;

        for row in 0..rows {

            let display_row = start_row + row;
            let start = offset.saturating_sub(display_cols);

            if display_row >= state.terminal_display.len() {
                continue;
            }

            let mut display_offset = 0;
            for i in start..offset {
                let display_col = (display_cols.saturating_sub(offset) + display_offset).saturating_sub(1);
                display_offset += 1;

                if i < cols {
                    state.terminal_display[display_row][display_col].set(strings[row][i]);
                } else {
                    state.terminal_display[display_row][display_col].set(0);
                }
            }
        }

        let still_running = offset < cols + display_cols;
        if !still_running {
            offset = 0;
        }

        return still_running;
    };
}
